# Generated by chezmoi from data/env.yaml. Edit data/env.yaml instead.

# Ensure user bin comes first if present
if test -d {{ quote (joinPath .chezmoi.home .data.env.paths.user_bin | replace "~" .chezmoi.home) }}
    set -l userbin {{ (joinPath .chezmoi.home .data.env.paths.user_bin | replace "~" .chezmoi.home) | quote }}
    if not contains -- $userbin $PATH
        set -gx PATH $userbin $PATH
    end
end

# NPM global bin
set -l npmglob {{ (joinPath .chezmoi.home .data.env.paths.npm_global_bin | replace "~" .chezmoi.home) | quote }}
if test -d $npmglob
    if not contains -- $npmglob $PATH
        set -gx PATH $npmglob $PATH
    end
end

# SSH agent via systemd user socket
if not set -q SSH_AUTH_SOCK
    set -gx SSH_AUTH_SOCK "$XDG_RUNTIME_DIR/ssh-agent.socket"
end

# Locale: prefer configured, fallback to C.UTF-8/C
if not set -q LANG
    set -l pref {{ .data.env.locale_preferred | quote }}
    if command -q locale
        if locale -a 2>/dev/null | grep -qi -- (string replace -r '\\.' '\\.' (string lower $pref))
            set -gx LANG $pref
        else if locale -a 2>/dev/null | grep -qi '^C.UTF-8$'
            set -gx LANG C.UTF-8
        else
            set -gx LANG C
        end
    else
        set -gx LANG C.UTF-8
    end
end

# Editor
if not set -q EDITOR
    set -gx EDITOR {{ .data.env.editor | quote }}
end

# Python
set -gx PYTHONDONTWRITEBYTECODE 1
set -gx PYTHONUNBUFFERED 1

# Node
set -gx NODE_ENV {{ .data.env.node_env | quote }}

# Ollama / Obsidian
set -gx OLLAMA_ORIGINS {{ .data.env.ollama_origins | quote }}

# GTK scale
set -gx SWT_GTK3 {{ printf "%v" .data.env.gtk.swt_gtk3 | quote }}
set -gx GDK_SCALE {{ printf "%v" .data.env.gtk.gdk_scale | quote }}
set -gx GDK_DPI_SCALE {{ printf "%v" .data.env.gtk.gdk_dpi_scale | quote }}

# Storage / NAS
set -gx STORAGE_IP {{ .data.env.storage.ip | quote }}
set -gx STORAGE_NAME {{ .data.env.storage.name | quote }}
